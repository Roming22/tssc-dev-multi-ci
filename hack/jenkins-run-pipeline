#!/bin/bash
SCRIPTDIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" > /dev/null 2>&1 && pwd)"

ENV="MY_JENKINS_SERVER MY_JENKINS_USER MY_JENKINS_BUILD_TOKEN MY_JENKINS_TOKEN COSIGN_SECRET_PASSWORD COSIGN_SECRET_KEY COSIGN_PUBLIC_KEY "

ENV+=" ACS__API_TOKEN ACS__CENTRAL_ENDPOINT GITOPS_AUTH_PASSWORD "
source $SCRIPTDIR/../rhtap/verify-deps-exist "$ENV" "java "

PNAME=$1
if [ -z $PNAME ]; then
    echo $0 pipelinename
    exit 0
fi

curl -X POST -u $MY_JENKINS_USER:$MY_JENKINS_TOKEN \
    $MY_JENKINS_SERVER/job/$PNAME/build?token=$MY_JENKINS_BUILD_TOKEN
